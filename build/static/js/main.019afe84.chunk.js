(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,n){},108:function(e,t){},111:function(e,t){},139:function(e,t){},140:function(e,t){},163:function(e,t,n){},165:function(e,t,n){"use strict";n.r(t);var r=n(8),s=n.n(r),o=n(92),a=n.n(o),c=(n(104),n(9)),u=n(1),i=n.n(u),l=n(3),d=n(4),v=n(5),p=n(24),f=n(20),m=n(23),g=n(27),w=n(7),b=n(17),h=n(96),y=n.n(h),U=(n(163),n(28)),k=n(97),A="https://twitter.com/".concat("nasty_piwo"),S=b.d.SystemProgram,x=(b.d.Keypair,Object.values(k._keypair.secretKey)),C=new Uint8Array(x),E=b.d.Keypair.fromSecretKey(C);console.log(E.publicKey.toString());var G=new w.PublicKey(U.metadata.address),K=Object(w.clusterApiUrl)("devnet"),O="processed",j=function(){var e=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).upvoteGif=Object(l.a)(i.a.mark(function e(){var t,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=L(),r=new b.a(U,G,t),e.next=5,r.rpc.upvoteGif(n.state.gifLink,{accounts:{baseAccount:E.publicKey,user:t.wallet.publicKey}});case 5:return console.log("GIF successfully upvoted"),e.next=8,D();case 8:e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error upvoting GIF:",e.t0),n.removeWalletAddressFromVoteArray(n.upvotedUsers,n.walletAddress),n.setState(function(e){return{voteCount:e.voteCount-=1,upvotedUsers:n.upvotedUsers}});case 15:case"end":return e.stop()}},e,null,[[0,10]])})),n.downvoteGif=Object(l.a)(i.a.mark(function e(){var t,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=L(),r=new b.a(U,G,t),e.next=5,r.rpc.downvoteGif(n.state.gifLink,{accounts:{baseAccount:E.publicKey,user:t.wallet.publicKey}});case 5:return console.log("GIF successfully downvoted"),e.next=8,D();case 8:e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error downvoting GIF:",e.t0),n.removeWalletAddressFromVoteArray(n.downvotedUsers,n.walletAddress),n.setState(function(e){return{voteCount:e.voteCount+=1,downvotedUsers:n.downvotedUsers}});case 15:case"end":return e.stop()}},e,null,[[0,10]])})),n.deleteGif=Object(l.a)(i.a.mark(function e(){var t,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=L(),r=new b.a(U,G,t),e.next=5,r.rpc.removeGif(n.state.gifLink,{accounts:{baseAccount:E.publicKey,user:t.wallet.publicKey}});case 5:return console.log("GIF successfully deleted"),e.next=8,D();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error deleting GIF:",e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])})),n.removeUpvote=Object(l.a)(i.a.mark(function e(){var t,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=L(),r=new b.a(U,G,t),e.next=5,r.rpc.cancleUpvoteGif(n.state.gifLink,{accounts:{baseAccount:E.publicKey,user:t.wallet.publicKey}});case 5:return console.log("GIF successfully downvoted"),e.next=8,D();case 8:e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error downvoting GIF:",e.t0),n.removeWalletAddressFromVoteArray(n.upvotedUsers,n.walletAddress),n.setState(function(e){return{voteCount:e.voteCount+=1,upvotedUsers:n.upvotedUsers}});case 15:case"end":return e.stop()}},e,null,[[0,10]])})),n.removeDownvote=Object(l.a)(i.a.mark(function e(){var t,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=L(),r=new b.a(U,G,t),e.next=5,r.rpc.cancleDownvoteGif(n.state.gifLink,{accounts:{baseAccount:E.publicKey,user:t.wallet.publicKey}});case 5:return console.log("GIF successfully downvoted"),e.next=8,D();case 8:e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error downvoting GIF:",e.t0),n.removeWalletAddressFromVoteArray(n.downvotedUsers,n.walletAddress),n.setState(function(e){return{voteCount:e.voteCount-=1,downvotedUsers:n.downvotedUsers}});case 15:case"end":return e.stop()}},e,null,[[0,10]])})),n.walletAddress=e.walletAddress.toString(),n.state={userAddress:"",gifLink:"",voteCount:0,upvotedUsers:[],downvotedUsers:[]},n.upvotedUsers=new Array,n.downvotedUsers=new Array,n.setVoteArray(n.upvotedUsers,n.props.upvotedUsers),n.setVoteArray(n.downvotedUsers,n.props.downvotedUsers),console.log("Upvoted Users: ".concat(n.upvotedUsers)),console.log("Downvoted Users: ".concat(n.downvotedUsers)),n.userUpvoted=!1,n.userDownvoted=!1,n.setUserVotedState(),n.incrementVoteCount=n.incrementVoteCount.bind(Object(g.a)(Object(g.a)(n))),n.decrementVoteCount=n.decrementVoteCount.bind(Object(g.a)(Object(g.a)(n))),n}return Object(m.a)(t,e),Object(v.a)(t,[{key:"setVoteArray",value:function(e,t){for(var n=0;n<t.length;n++){var r=this.pubkeyToString(t[n]);e.push(r)}}},{key:"pubkeyToString",value:function(e){return e.toString()}},{key:"componentDidMount",value:function(){this.setState({userAddress:this.props.userAddress.toString(),gifLink:this.props.gifLink.toString(),voteCount:this.props.voteCount,upvotedUsers:this.props.upvotedUsers,downvotedUsers:this.props.downvotedUsers})}},{key:"voteArrayContainsWalletAddress",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}},{key:"removeWalletAddressFromVoteArray",value:function(e,t){for(var n=0;n<e.length;n++)e[n]===t&&e.splice(n,1)}},{key:"setUserVotedState",value:function(){this.userUpvoted=this.voteArrayContainsWalletAddress(this.upvotedUsers,this.walletAddress),this.userDownvoted=this.voteArrayContainsWalletAddress(this.downvotedUsers,this.walletAddress)}},{key:"cancleUpvote",value:function(){var e=this;this.removeWalletAddressFromVoteArray(this.upvotedUsers,this.walletAddress),this.setState(function(t){return{voteCount:t.voteCount-=1,upvotedUsers:e.upvotedUsers}}),this.removeUpvote(),console.log("Upvote removed...")}},{key:"cancleDownvote",value:function(){var e=this;this.removeWalletAddressFromVoteArray(this.downvotedUsers,this.walletAddress),this.setState(function(t){return{voteCount:t.voteCount+=1,downvotedUsers:e.downvotedUsers}}),this.removeDownvote(),console.log("Downvote removed...")}},{key:"incrementVoteCount",value:function(){var e=this;this.setUserVotedState(),this.userUpvoted||this.userDownvoted?!this.userUpvoted&&this.userDownvoted&&this.cancleDownvote():(this.upvotedUsers.push(this.walletAddress),this.setState(function(t){return{voteCount:t.voteCount+=1,upvotedUsers:e.upvotedUsers}}),this.upvoteGif(),console.log("Upvote count incremented...")),this.setUserVotedState()}},{key:"decrementVoteCount",value:function(){var e=this;this.setUserVotedState(),this.userUpvoted||this.userDownvoted?this.userUpvoted&&!this.userDownvoted&&this.cancleUpvote():(this.downvotedUsers.push(this.walletAddress),this.setState(function(t){return{voteCount:t.voteCount-=1,downvotedUsers:e.downvotedUsers}}),this.downvoteGif(),console.log("Downvote count incremented...")),this.setUserVotedState()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"gif-item"},s.a.createElement("div",{className:"gif-item-content"},s.a.createElement("small",{className:"gif-user-address"},"User address: ",this.props.userAddress.toString()),s.a.createElement("img",{src:this.props.gifLink.toString()})),s.a.createElement("div",{className:"gif-side-container"},s.a.createElement("div",{className:"gif-vote-container"},s.a.createElement("button",{className:"gif-upvote-button",onClick:this.incrementVoteCount},"\u2b06"),(e.setUserVotedState(),e.userUpvoted&&!e.userDownvoted?s.a.createElement("p",{className:"gif-upvote-count"},e.state.voteCount):e.userDownvoted&&!e.userUpvoted?s.a.createElement("p",{className:"gif-downvote-count"},e.state.voteCount):s.a.createElement("p",{className:"gif-standard-count"},e.state.voteCount)),s.a.createElement("button",{className:"gif-downvote-button",onClick:this.decrementVoteCount},"\u2b07")),function(){if(e.props.userAddress.toString()==e.walletAddress)return s.a.createElement("button",{className:"delete-button",onClick:e.deleteGif},"X")}()))}}]),t}(s.a.Component),t=Object(r.useState)(null),n=Object(c.a)(t,2),o=n[0],a=n[1],u=Object(r.useState)(""),h=Object(c.a)(u,2),k=h[0],x=h[1],C=Object(r.useState)([]),j=Object(c.a)(C,2),N=j[0],F=j[1];Object(r.useEffect)(function(){var e=function(){var e=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V();case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return window.addEventListener("load",e),function(){return window.removeEventListener("load",e)}},[]),Object(r.useEffect)(function(){o&&(console.log("Fetching GIF list..."),D())},[o]);var V=function(){var e=Object(l.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=window,!(n=t.solana)){e.next=12;break}if(!n.isPhantom){e.next=10;break}return console.log("Phantom wallet found!"),e.next=7,n.connect({onlyIfTrusted:!0});case 7:r=e.sent,console.log("Connected with Public Key:",r.publicKey.toString()),a(r.publicKey.toString());case 10:e.next=13;break;case 12:alert("Solana object not found! Get a Phantom Wallet \ud83d\udc7b");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,null,[[0,15]])}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=new w.Connection(K,O);return new b.b(e,window.solana,O)},I=function(){var e=Object(l.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window,!(n=t.solana)){e.next=7;break}return e.next=4,n.connect();case 4:r=e.sent,console.log("Connected with Public Key:",r.publicKey.toString()),a(r.publicKey.toString());case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(l.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=L(),n=new b.a(U,G,t),e.next=5,n.account.baseAccount.fetch(E.publicKey);case 5:r=e.sent,console.log("Got the account",r),F(r.gifList),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error in getGifList: ",e.t0),F(null);case 14:case"end":return e.stop()}},e,null,[[0,10]])}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==k.length){e.next=3;break}return console.log("No gif link given!"),e.abrupt("return");case 3:return x(""),console.log("Gif link:",k),e.prev=5,t=L(),n=new b.a(U,G,t),e.next=10,n.rpc.addGif(k,{accounts:{baseAccount:E.publicKey,user:t.wallet.publicKey}});case 10:return console.log("GIF successfully sent to program",k),e.next=13,D();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),console.log("Error sending GIF:",e.t0);case 18:case"end":return e.stop()}},e,null,[[5,15]])}));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=L(),n=new b.a(U,G,t),console.log("ping"),e.next=6,n.rpc.startStuffOff({accounts:{baseAccount:E.publicKey,user:t.wallet.publicKey,systemProgram:S.programId},signers:[E]});case 6:return console.log("Created a new BaseAccount w/ address:",E.publicKey.toString()),e.next=9,D();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("Error creating BaseAccount account:",e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}(),P=function(e){var t=e.target.value;x(t)},T=function(e){e.preventDefault(),M()};return s.a.createElement("div",{className:"App"},s.a.createElement("div",{className:o?"authed-container":"container"},s.a.createElement("div",{className:"header-container"},s.a.createElement("p",{className:"header"},"\ud83e\udda7 GIF Portal"),s.a.createElement("p",{className:"sub-text"},"View your orangutan GIF collection in the metaverse \u2728"),!o&&s.a.createElement("button",{className:"cta-button connect-wallet-button",onClick:I},"Connect to Wallet"),o&&function(){var t=L();return null===N?s.a.createElement("div",{className:"connected-container"},s.a.createElement("button",{className:"cta-button submit-gif-button",onClick:W},"Do One-Time Initialization For GIF Program Account")):s.a.createElement("div",{className:"connected-container"},s.a.createElement("form",{onSubmit:T},s.a.createElement("input",{type:"text",placeholder:"Enter gif link!",value:k,onChange:P}),s.a.createElement("button",{type:"submit",className:"cta-button submit-gif-button"},"Submit")),s.a.createElement("div",{className:"gif-grid"},N.map(function(n,r){return s.a.createElement(e,{className:"gif-item-container",key:r,userAddress:n.userAddress,gifLink:n.gifLink,upvotedUsers:n.upvotedUsers,downvotedUsers:n.downvotedUsers,voteCount:n.voteCount,walletAddress:t.wallet.publicKey})})))}()),s.a.createElement("div",{className:"footer-container"},s.a.createElement("img",{alt:"Twitter Logo",className:"twitter-logo",src:y.a}),s.a.createElement("a",{className:"footer-text",href:A,target:"_blank",rel:"noreferrer"},"built by @".concat("nasty_piwo")))))};a.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(j,null)),document.getElementById("root"))},28:function(e){e.exports={version:"0.1.0",name:"gifportalbackend",instructions:[{name:"startStuffOff",accounts:[{name:"baseAccount",isMut:!0,isSigner:!0},{name:"user",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[],returns:null},{name:"addGif",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[{name:"gifLink",type:"string"}],returns:null},{name:"upvoteGif",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[{name:"gifLink",type:"string"}],returns:null},{name:"cancleUpvoteGif",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[{name:"gifLink",type:"string"}],returns:null},{name:"downvoteGif",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[{name:"gifLink",type:"string"}],returns:null},{name:"cancleDownvoteGif",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[{name:"gifLink",type:"string"}],returns:null},{name:"removeGif",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[{name:"gifLink",type:"string"}],returns:null}],accounts:[{name:"BaseAccount",type:{kind:"struct",fields:[{name:"totalGifs",type:"u64"},{name:"gifList",type:{vec:{defined:"ItemStruct"}}}]}}],types:[{name:"ItemStruct",type:{kind:"struct",fields:[{name:"gifLink",type:"string"},{name:"userAddress",type:"publicKey"},{name:"upvotedUsers",type:{vec:"publicKey"}},{name:"downvotedUsers",type:{vec:"publicKey"}},{name:"voteCount",type:"i32"}]}}],metadata:{address:"338BZQTraQYe4yLfDa6Cb4WMACeF3ccv3umBKTER7R96"}}},96:function(e,t,n){e.exports=n.p+"static/media/twitter-logo.5c97ee2a.svg"},97:function(e){e.exports={_keypair:{publicKey:{0:51,1:131,2:161,3:174,4:242,5:191,6:242,7:145,8:209,9:18,10:109,11:6,12:51,13:225,14:46,15:197,16:55,17:104,18:245,19:21,20:32,21:106,22:128,23:232,24:254,25:50,26:123,27:25,28:49,29:42,30:105,31:225},secretKey:{0:181,1:71,2:239,3:161,4:58,5:222,6:231,7:203,8:107,9:95,10:250,11:228,12:46,13:213,14:36,15:249,16:80,17:154,18:5,19:110,20:137,21:168,22:188,23:61,24:146,25:96,26:65,27:124,28:121,29:89,30:251,31:144,32:51,33:131,34:161,35:174,36:242,37:191,38:242,39:145,40:209,41:18,42:109,43:6,44:51,45:225,46:46,47:197,48:55,49:104,50:245,51:21,52:32,53:106,54:128,55:232,56:254,57:50,58:123,59:25,60:49,61:42,62:105,63:225}}}},99:function(e,t,n){e.exports=n(165)}},[[99,2,1]]]);
//# sourceMappingURL=main.019afe84.chunk.js.map